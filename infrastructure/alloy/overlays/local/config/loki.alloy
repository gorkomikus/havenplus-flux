// LOKI LOGS
loki.source.kubernetes "pods" {
  targets    = discovery.relabel.pods.output
  forward_to = [loki.process.pods.receiver]
}

loki.process "pods" {
    stage.drop {
        older_than = "6h"
        drop_counter_reason = "logs are older than 6 hours"
    }

    forward_to = [loki.write.main.receiver]
}

loki.write "main" {
    endpoint {
        url = "http://loki.loki.svc.cluster.local:3100/loki/api/v1/push"
        tenant_id = "1"
    }
}
